# Swans

This repository contains code and data to reproduce the analyses in Soriano-Redondo et al. Demographic rates reveal the benefits of protected areas in a long-lived migratory bird (submitted to PNAS).

The code to reproduce the multistate survival and movement model is provided as <b>WS_CMR_TD.R</b> and the Capture History dataset used for that analysis is provided as <b>Whooper_MS_Age_Encounter.csv</b>. The multistate model that accounts for trap-dependence in the adult swans was adapted from Kéry & Schaub (2012) by <strong><a href="https://fwce.nmsu.edu/faculty-staff/fitsum-abadi-gebreselass.html" target="_blank">Dr Fitsum Abadi Gebreselassie</a></strong>.

The code to reproduce the final productivty model is provided as <b>WS_Breeding_Model.R</b> and the associated code used for that analysis is provided as <b>StandardisedWhooperData.csv</b>. The initial model selection using a frequentist framework (not incuded in the code) was conducted by <strong><a href="https://research.com/u/richard-inger" target="_blank">Richard Inger</a></strong> and the model to specify the minimally adequate binomial GLMM in JAGS was coded by <strong><a href="https://ecologyconservation.exeter.ac.uk/staff/profile/index.php?web_id=Richard_Sherley" target="_blank">Richard B. Sherley</a></strong>.

The code to reproduce the population model is provided as <b>WS_PPM.R</b>. There are two associated csv files, which are required to run the code. <b>BSData.csv</b> provides the annual brood size data from the WWT’s Swan Monitoring Program for the years 1990 to 2011. These values are used in the model to specify an informative prior (based on a truncated Gamma distrubution) for R, the number of offspring per female. <b>PopData.csv</b> provides population counts from the WWT's monitoring program inside (WWTP) and outside (TP) of WWT nature reserves for the years 1985/86 to 2014/15. These data are used to seed the populaiton projection models and are plotted against the projections for comparative purposes. To run the WS_PPM.R code, it is also necessary to have outputs from the multistate survival and movement model and the productivty model. To generate these, you can either run the code yourself (but be warned, the multistate CMR takes a long time to run) or you can access a data file containing the posterior distributions from the final model runs as per the results in the manuscript here:  
