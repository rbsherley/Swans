# Swans

This repository contains code and data to reproduce the analyses in Soriano-Redondo et al. Demographic rates reveal the benefits of protected areas in a long-lived migratory bird (submitted to PNAS).

The code to reproduce the multistate survival and movement model is provided as <strong><a href="https://github.com/rbsherley/Swans/blob/main/WS_CMR_TD.R" target="_blank" rel="noopener noreferrer">WS_CMR_TD.R</a></strong> and the Capture History dataset used for that analysis is provided as <strong><a href="https://github.com/rbsherley/Swans/blob/main/Whooper_MS_Age_Encounter.csv" target="_blank" rel="noopener noreferrer">Whooper_MS_Age_Encounter.csv</a></strong>. The multistate model that accounts for trap-dependence in the adult swans was adapted from Kéry & Schaub (2012) by <strong><a href="https://fwce.nmsu.edu/faculty-staff/fitsum-abadi-gebreselass.html" target="_blank" rel="noopener noreferrer">Dr Fitsum Abadi Gebreselassie</a></strong>.

The code to reproduce the final productivty model is provided as <b>WS_Breeding_Model.R</b> and the associated code used for that analysis is provided as <b>StandardisedWhooperData.csv</b>. The initial model selection using a frequentist framework (not incuded in the code) was conducted by <strong><a href="https://research.com/u/richard-inger" target="_blank" rel="noopener noreferrer">Richard Inger</a></strong> and the model to specify the minimally adequate binomial GLMM in JAGS was coded by <strong><a href="https://ecologyconservation.exeter.ac.uk/staff/profile/index.php?web_id=Richard_Sherley" target="_blank" rel="noopener noreferrer">Richard B. Sherley</a></strong>.

The code to reproduce the population model is provided as <strong><a href="https://github.com/rbsherley/Swans/blob/main/WS_PPM.R" target="_blank" rel="noopener noreferrer">WS_PPM.R</a></strong>. There are two associated csv files, which are required to run the code. <strong><a href="https://github.com/rbsherley/Swans/blob/main/BSData.csv" target="_blank" rel="noopener noreferrer">BSData.csv</a></strong> provides the annual brood size data from the WWT’s Swan Monitoring Program for the years 1990 to 2011. These values are used in the model to specify an informative prior (based on a truncated Gamma distrubution) for R, the number of offspring per female. <strong><a href="https://github.com/rbsherley/Swans/blob/main/PopData.csv" target="_blank" rel="noopener noreferrer">PopData.csv</a></strong> provides population counts from the WWT's monitoring program inside (WWTP) and outside (TP) of WWT nature reserves for the years 1985/86 to 2014/15. These data are used to seed the populaiton projection models and are plotted against the projections for comparative purposes. To run the WS_PPM.R code, it is also necessary to have outputs from the multistate survival and movement model and the productivty model. To generate these, you can either run the code yourself and save the JAGS outputs (but be warned, the multistate CMR takes a long time to run) or you can use the data files containing the posterior distributions from the final model runs as per the results in the manuscript for the multistate survival and movement model (<strong><a href="https://github.com/rbsherley/Swans/blob/main/ws_ms_1_td.RData" target="_blank" rel="noopener noreferrer">ws_ms_1_td.RData</a></strong>) and for the breeding productivity model (<strong><a href="https://drive.google.com/file/d/12LcixA3E10A3lWw2tPh2QZbShwSfMMpn/view?usp=sharing" target="_blank" rel="noopener noreferrer">BreedingSuccessModel.RData</a></strong>; not on GitHub because of the file size). The population model was initially coded by Richard Sherley with subsequent development from <strong><a href="https://scholar.google.co.uk/citations?user=StT5BbgAAAAJ&hl=en" target="_blank" rel="noopener noreferrer">Andrea Soriano-Redondo</a></strong>. Andrea Soriano-Redondo also used a modified version of this code to calculate the elasticities.
